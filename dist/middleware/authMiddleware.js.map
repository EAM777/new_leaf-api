{"version":3,"sources":["../../src/middleware/authMiddleware.js"],"names":["TOKENTIME","SECRET","authenticate","secret","algorithms","generatedAccessToken","req","res","next","token","jwt","sign","id","user","expiresIn","respond","status","json","username","userId","userInfo","issue","iat","expire","exp","module","exports"],"mappings":";;AAAA;;;;AACA;;;;;;AAEA,IAAMA,YAAY,KAAK,EAAL,GAAU,EAAV,GAAe,EAAjC,C,CAAsC;AACtC,IAAMC,SAAS,sBAAf;;AAEA,IAAIC,eAAe,0BAAW,EAAEC,QAAQF,MAAV;AAC9BG,cAAY,CAAC,OAAD,CADkB,EAAX,CAAnB;;AAGA,IAAIC,uBAAuB,SAAvBA,oBAAuB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC7CF,MAAIG,KAAJ,GAAYH,IAAIG,KAAJ,IAAa,EAAzB;AACAH,MAAIG,KAAJ,GAAYC,uBAAIC,IAAJ,CAAS;AACnBC,QAAIN,IAAIO,IAAJ,CAASD;AADM,GAAT,EAETX,MAFS,EAED;AACTa,eAAWd,SADF,CACY;AADZ,GAFC,CAAZ;AAKAQ;AACD,CARD;;AAUA,IAAIO,UAAU,SAAVA,OAAU,CAACT,GAAD,EAAMC,GAAN,EAAc;AAC1BA,MAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBJ,UAAMP,IAAIO,IAAJ,CAASK,QADI;AAEnBC,YAAQb,IAAIO,IAAJ,CAASD,EAFE;AAGnBH,WAAOH,IAAIG;AAHQ,GAArB;AAKD,CAND;;AAQA,IAAIW,WAAW,SAAXA,QAAW,CAACd,GAAD,EAAMC,GAAN,EAAc;AAC3BA,MAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACrB;AACA;AACEI,WAAOf,IAAIO,IAAJ,CAASS,GAHG;AAInBC,YAAQjB,IAAIO,IAAJ,CAASW;AAJE,GAArB;AAMD,CAPD;;AASAC,OAAOC,OAAP,GAAiB;AACfxB,4BADe;AAEfG,4CAFe;AAGfU;AAHe,CAAjB","file":"authMiddleware.js","sourcesContent":["import jwt from 'jsonwebtoken';\nimport expressJwt from 'express-jwt';\n\nconst TOKENTIME = 60 * 60 * 24 * 30 ; // 30 days\nconst SECRET = \"W3 Hav3 th3 kn0w h0w\";\n\nlet authenticate = expressJwt({ secret: SECRET,\nalgorithms: ['HS256'] });\n\nlet generatedAccessToken = (req, res, next) => {\n  req.token = req.token || {};\n  req.token = jwt.sign({\n    id: req.user.id,\n  }, SECRET, {\n    expiresIn: TOKENTIME // 30 Days\n  });\n  next();\n}\n\nlet respond = (req, res) => {\n  res.status(200).json({\n    user: req.user.username,\n    userId: req.user.id,\n    token: req.token\n  });\n}\n\nlet userInfo = (req, res) => {\n  res.status(200).json({\n  //  userId: req.user.id,\n  //  user: req.user.username,\n    issue: req.user.iat,\n    expire: req.user.exp\n  })\n}\n\nmodule.exports = {\n  authenticate,\n  generatedAccessToken,\n  respond\n}\n"]}